<% users.each do |u| %>

<div>
    <div>Username: <%= u.username %></div>
    <div>Role: <%= u.role %></div>
    <div> Change role
    </div>
        <button data-userid="<%= u.id %>" data-role="recycler" onclick="changeRole(this)"> Recycler </button>
        <button data-userid="<%= u.id %>" data-role="user" onclick="changeRole(this)"> User </button>
        <button data-userid="<%= u.id %>" data-role="admin" onclick="changeRole(this)"> Admin </button>
</div>

<% end %>

<script type="text/javascript">
  const changeRole =(e)=>{ 
    fetch(`/users/${e.getAttribute("data-userid")}/role`,{
        method: "PATCH",
            headers: {
    'X-CSRF-Token' :document.head.querySelector('meta[name="csrf-token"]').content,
    'Content-Type': 'application/json'
    },
        body: JSON.stringify({role:e.getAttribute("data-role")})
    })
  }
</script>
